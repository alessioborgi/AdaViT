Using cache found in /home/studio-lab-user/.cache/torch/hub/facebookresearch_deit_main
Training epoch 0:   0%|                                                                                                                                                                                                                   | 0/74 [00:00<?, ?it/s]
Archive found at AdaViT/imagenette_dataset/imagenette.zip, skipping download
Extracted file found at AdaViT/imagenette_dataset/imagenette2-160, skipping extraction
Warning: num_classes is not used for Imagenette dataset.
Ignoring the argument and using default number of classes in this dataset (10).
Loading timm pretrained weights:  ['facebookresearch/deit:main', 'deit_tiny_patch16_224']
Downloading timm pretrained weights:  ['facebookresearch/deit:main', 'deit_tiny_patch16_224']
Loading weights for a different number of classes. Replacing head with random weights. You should fine-tune the model.
The Model is:  AdaptiveVisionTransformer(
  (conv_proj): Conv2d(3, 192, kernel_size=(16, 16), stride=(16, 16))
  (encoder): AViTEncoder(
    (dropout): Dropout(p=0.0, inplace=False)
    (layers): ModuleList(
      (0-11): 12 x AViTBlock(
        (ln_1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
        (self_attention): SelfAttention(
          (self_attention): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=192, out_features=192, bias=True)
          )
        )
        (dropout): Dropout(p=0.0, inplace=False)
        (ln_2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
        (mlp): MLP(
          (fc1): Linear(in_features=192, out_features=768, bias=True)
          (fc2): Linear(in_features=768, out_features=192, bias=True)
        )
      )
    )
    (ln): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
  )
  (head): Linear(in_features=192, out_features=10, bias=True)
)
Reinitializing class_tokens... Reinitialized!
Freezing all parameters except for those containing any of these words in their names:  ['gate', 'class', 'head', 'threshold', 'budget']
Trainable parameters: ['class_tokens', 'head.weight', 'head.bias']















Training epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:31<00:00,  2.36it/s]


Validation epoch 0 : 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 31/31 [00:06<00:00,  4.92it/s]
Training epoch 1:   1%|██▋                                                                                                                                                                                                        | 1/74 [00:01<01:29,  1.23s/it]
Saving training state for epoch 0.
[WARNING] Plotting masks is only supported for models with a budget. Skipping...














Training epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.45it/s]
Training epoch 2:   1%|██▋                                                                                                                                                                                                        | 1/74 [00:01<01:43,  1.42s/it]














Training epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]
Training epoch 3:   0%|                                                                                                                                                                                                                   | 0/74 [00:00<?, ?it/s]














Training epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.44it/s]
Training epoch 4:   0%|                                                                                                                                                                                                                   | 0/74 [00:00<?, ?it/s]














Training epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]
Training epoch 5:   0%|                                                                                                                                                                                                                   | 0/74 [00:00<?, ?it/s]














Training epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]
Training epoch 6:   0%|                                                                                                                                                                                                                   | 0/74 [00:00<?, ?it/s]















Training epoch 6: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.42it/s]
Training epoch 7:   1%|██▋                                                                                                                                                                                                        | 1/74 [00:01<01:31,  1.25s/it]














Training epoch 7: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.44it/s]
Training epoch 8:   1%|██▋                                                                                                                                                                                                        | 1/74 [00:01<01:30,  1.24s/it]














Training epoch 8: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.44it/s]
Training epoch 9:   0%|                                                                                                                                                                                                                   | 0/74 [00:00<?, ?it/s]














Training epoch 9: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]
Training epoch 10:   0%|                                                                                                                                                                                                                  | 0/74 [00:00<?, ?it/s]














Training epoch 10: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]
Training epoch 11:   0%|                                                                                                                                                                                                                  | 0/74 [00:00<?, ?it/s]
Saving training state for epoch 10.
[WARNING] Plotting masks is only supported for models with a budget. Skipping...















Training epoch 11: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]
Training epoch 12:   1%|██▋                                                                                                                                                                                                       | 1/74 [00:01<01:46,  1.46s/it]














Training epoch 12:  97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     | 72/74 [00:29<00:00,  2.52it/s]
Training epoch 12: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.42it/s]














Training epoch 13:  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊        | 71/74 [00:29<00:01,  2.51it/s]
Training epoch 13: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]














Training epoch 14:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 70/74 [00:28<00:01,  2.52it/s]
Training epoch 14: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.42it/s]














Training epoch 15:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 70/74 [00:28<00:01,  2.52it/s]
Training epoch 15: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.44it/s]















Training epoch 16:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 73/74 [00:29<00:00,  2.51it/s]
Training epoch 16: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.44it/s]














Training epoch 17:  97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     | 72/74 [00:29<00:00,  2.52it/s]
Training epoch 17: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.42it/s]














Training epoch 18:  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊        | 71/74 [00:29<00:01,  2.52it/s]
Training epoch 18: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.44it/s]














Training epoch 19:  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊        | 71/74 [00:29<00:01,  2.52it/s]
Training epoch 19: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]














Training epoch 20:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 70/74 [00:28<00:01,  2.52it/s]
Saving training state for epoch 20.
[WARNING] Plotting masks is only supported for models with a budget. Skipping...
Training epoch 20: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.44it/s]














Training epoch 21: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]
Training epoch 22:   0%|                                                                                                                                                                                                                  | 0/74 [00:00<?, ?it/s]















Training epoch 22:  97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     | 72/74 [00:29<00:00,  2.52it/s]
Training epoch 22: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]














Training epoch 23:  97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     | 72/74 [00:29<00:00,  2.52it/s]
Training epoch 23: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]














Training epoch 24:  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊        | 71/74 [00:29<00:01,  2.52it/s]
Training epoch 24: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]














Training epoch 25:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 70/74 [00:28<00:01,  2.52it/s]
Training epoch 25: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]














Training epoch 26: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.44it/s]
Training epoch 27:   0%|                                                                                                                                                                                                                  | 0/74 [00:00<?, ?it/s]















Training epoch 27:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 73/74 [00:29<00:00,  2.52it/s]
Training epoch 27: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.44it/s]














Training epoch 28:  97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     | 72/74 [00:29<00:00,  2.52it/s]
Training epoch 28: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]














Training epoch 29:  97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     | 72/74 [00:29<00:00,  2.51it/s]
Training epoch 29: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]














Training epoch 30:  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊        | 71/74 [00:29<00:01,  2.52it/s]
Saving training state for epoch 30.
[WARNING] Plotting masks is only supported for models with a budget. Skipping...
Training epoch 30: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]














Training epoch 31: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.43it/s]
Training epoch 32:   0%|                                                                                                                                                                                                                  | 0/74 [00:00<?, ?it/s]















Training epoch 32:  97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     | 72/74 [00:30<00:00,  2.51it/s]
Training epoch 32: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 74/74 [00:30<00:00,  2.40it/s]
Training epoch 33:   0%|                                                                                                                                                                                                                  | 0/74 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/studio-lab-user/sagemaker-studiolab-notebooks/AdaViT/train/train.py", line 225, in <module>
    train()
  File "/home/studio-lab-user/.conda/envs/studiolab/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/studio-lab-user/.conda/envs/studiolab/lib/python3.9/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/studio-lab-user/.conda/envs/studiolab/lib/python3.9/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/studio-lab-user/.conda/envs/studiolab/lib/python3.9/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/studio-lab-user/.conda/envs/studiolab/lib/python3.9/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/studio-lab-user/.conda/envs/studiolab/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/home/studio-lab-user/.conda/envs/studiolab/lib/python3.9/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/studio-lab-user/sagemaker-studiolab-notebooks/AdaViT/train/train.py", line 203, in train
    train_epoch(model, train_loader, optimizer, epoch)
  File "/home/studio-lab-user/sagemaker-studiolab-notebooks/AdaViT/train/train.py", line 107, in train_epoch
    for batch, labels in tqdm(loader, desc=f'Training epoch {epoch}'):
  File "/home/studio-lab-user/.conda/envs/studiolab/lib/python3.9/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/studio-lab-user/.conda/envs/studiolab/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/home/studio-lab-user/.conda/envs/studiolab/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1329, in _next_data
    idx, data = self._get_data()
  File "/home/studio-lab-user/.conda/envs/studiolab/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1285, in _get_data
    success, data = self._try_get_data()
  File "/home/studio-lab-user/.conda/envs/studiolab/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1133, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/studio-lab-user/.conda/envs/studiolab/lib/python3.9/queue.py", line 180, in get
    self.not_empty.wait(remaining)
  File "/home/studio-lab-user/.conda/envs/studiolab/lib/python3.9/threading.py", line 316, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt